<div class="layout-wrapper layout-static" (click)="doLayoutClick()"
     [ngClass]="{'layout-mobile-active': (staticMenuMobileActive$ | async),
     'layout-static-inactive': (staticMenuDesktopInactive$ | async)}">

  <div class="layout-main">
    <div class="layout-topbar">
      <a href="#" id="layout-menu-btn" class="menu-btn" (click)="doToggleMenuLeft($event);">
        <i class="pi pi-bars"></i>
      </a>
      <div class="layout-topbar-menu-wrapper">
        <ng-container *ngIf="(isLoggedIn$ | async); else logInButton">
          <ng-container *ngIf="profileVm$ | async as profileVm">
            <ng-container *ngIf="profileVm.isLoaded">
              <button type="button" pButton label="" class="p-button-outlined fix-label" (click)="menu.toggle($event)">
                <span>{{profileVm.profile?.username}}</span>&nbsp;
                <i class="pi pi-angle-down"></i>
              </button>
            </ng-container>
            <ng-container *ngIf="profileVm.isLoading">
              <p-skeleton width="5rem" height="2rem"></p-skeleton>
            </ng-container>
          </ng-container>
        </ng-container>
      </div>
    </div>
    <div class="layout-content">
      <router-outlet></router-outlet>
    </div>
    <div class="layout-main-mask"></div>
  </div>

  <div class="layout-sidebar" (click)="doMenuClick()">
    <div class="layout-sidebar-logo"></div>
    <div class="layout-menu-container">

      <ng-container *ngIf="isLoadingMenu$ | async; else showMenu">
        <div class="p-p-3">
          <p-skeleton styleClass="p-mb-1" height="3rem"></p-skeleton>
          <p-skeleton styleClass="p-mb-1" height="3rem"></p-skeleton>
          <p-skeleton height="3rem"></p-skeleton>
        </div>
      </ng-container>
      <ng-template #showMenu>
        <hsc-nav-bar [items]="navList$ | async"></hsc-nav-bar>
      </ng-template>
    </div>
  </div>
</div>

<p-menu #menu [popup]="true" [model]="userItems"></p-menu>
<ng-template #logInButton>
  <button type="button" pButton label="Login" class="p-button-outlined fix-label" (click)="login()"></button>
</ng-template>
